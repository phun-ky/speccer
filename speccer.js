!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).speccer={})}(this,(function(t){"use strict";const e=(t,e,o="noop")=>{t&&(!e||e&&0===e.length||e.trim().split(" ").filter((t=>t!==o)).forEach((e=>t.classList.add(e))))},o=(t,e)=>t?e||"string"==typeof t?`${t} ${e?Object.keys(e).filter((t=>e[t])).join(" "):""}`.trim():`${Object.keys(t).filter((e=>t[e])).join(" ")}`.trim():"",n=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ"],i=t=>parseInt(t,10),r=t=>i(getComputedStyle(t).getPropertyValue("--ph-speccer-pin-space"))||48,a=()=>new Promise(requestAnimationFrame),s=async(t,e)=>{!t||!e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||Array.isArray(e)&&0===e.length||0===Object.keys(e).length&&e.constructor===Object||(await a(),Array.isArray(e)?e.forEach((e=>t.style[e.key]=e.value)):Object.keys(e).forEach((o=>t.style[o]=e[o])))},p=async t=>(await a(),getComputedStyle(t,null)),c=(t,e,o)=>t-e.width/2+o.width/2,l=(t,e,o)=>t-e.height/2+o.height/2,h=async t=>{await a();const e=t.getBoundingClientRect(),o=e.top+window.pageYOffset,n=e.left+window.pageXOffset;return{height:e.height,width:e.width,top:o,left:n}},d=async(t,e)=>{await a();const o=t.getBoundingClientRect(),n=await h(e),i=await(async(t,e)=>{await a();const o=t.getBoundingClientRect(),n=e.getBoundingClientRect(),i=n.top+window.pageYOffset,r=n.left+window.pageXOffset;return{height:n.height,width:n.width,top:l(i,o,n),left:c(r,o,n)}})(t,e),r=n.height,s=n.width,p=o.height,d=o.width;return{absolute:()=>({top:n.top,left:n.left,height:r,width:s}),toTop:({center:t=!1,sourceHeight:e=p,modifier:o=0}={})=>({top:n.top-(e+o),left:t?i.left:n.left,height:r,width:s}),fromTop:({center:t=!1}={})=>({top:n.top,left:t?i.left:n.left,height:r,width:s}),toBottom:({center:t=!1,sourceHeight:e=p,targetHeight:o=r}={})=>({top:n.top+o-e,left:t?i.left:n.left,height:r,width:s}),fromBottom:({center:t=!1,targetHeight:e=r,modifier:o=0}={})=>({top:n.top+e+o,left:t?i.left:n.left,height:r,width:s}),toLeft:({center:t=!1,sourceWidth:e=d,modifier:o=0}={})=>({top:t?i.top:n.top,left:n.left-e-o,height:r,width:s}),fromLeft:({center:t=!1}={})=>({top:t?i.top:n.top,left:n.left,height:r,width:s}),toRight:({center:t=!1,sourceWidth:e=d,targetWidth:o=s,modifier:a=0}={})=>({top:t?i.top:n.top,left:n.left+o-e+a,height:r,width:s}),fromRight:({center:t=!1,targetWidth:e=s,modifier:o=0}={})=>({top:t?i.top:n.top,left:n.left+e+o,height:r,width:s})}},f=(t="",o="span")=>{const n=document.createElement(o),i=document.createTextNode(t+"");return n.appendChild(i),n.setAttribute("title",t+"px"),e(n,"ph speccer spacing"),n},u=async t=>{if(!t)return;const o=await p(t);if("none"===o.display||"0"===o.opacity||"hidden"===o.visibility)return;const n=(t=>{const{marginTop:e,marginBottom:o,marginLeft:n,marginRight:i,paddingTop:r,paddingBottom:a,paddingLeft:s,paddingRight:p}=t;return{marginTop:e,marginBottom:o,marginLeft:n,marginRight:i,paddingTop:r,paddingBottom:a,paddingLeft:s,paddingRight:p}})(o),r=Object.keys(n).filter((t=>"0px"!==n[t]));0!==r.length&&r.forEach((async o=>{const r=i(n[o]),p=f(r),c=(t=>-1!==t.indexOf("Top")?t.replace("Top"," top"):-1!==t.indexOf("Right")?t.replace("Right"," right"):-1!==t.indexOf("Bottom")?t.replace("Bottom"," bottom"):-1!==t.indexOf("Left")?t.replace("Left"," left"):"")(o);e(p,c),document.body.appendChild(p),t.classList.add("is-specced"),await(async(t,e,o,n)=>{await a();const i=n.getBoundingClientRect(),r=await h(n);"marginTop"===t&&s(o,{height:`${e}px`,width:i.width+"px",left:r.left+"px",top:r.top-e+"px"}),"marginRight"===t&&s(o,{height:i.height+"px",width:`${e}px`,left:r.left+parseInt(i.width+"",10)+"px",top:r.top+"px"}),"marginBottom"===t&&s(o,{height:`${e}px`,width:i.width+"px",left:r.left+"px",top:r.top+parseInt(i.height+"",10)+"px"}),"marginLeft"===t&&s(o,{height:i.height+"px",width:`${e}px`,left:r.left-e+"px",top:r.top+"px"}),"paddingTop"===t&&s(o,{height:`${e}px`,width:i.width+"px",left:r.left+"px",top:r.top+"px"}),"paddingBottom"===t&&s(o,{height:`${e}px`,width:i.width+"px",left:r.left+"px",top:r.top+(parseInt(i.height+"",10)-e)+"px"}),"paddingRight"===t&&s(o,{height:i.height+"px",width:`${e}px`,left:r.left+(parseInt(i.width+"",10)-e)+"px",top:r.top+"px"}),"paddingLeft"===t&&s(o,{height:i.height+"px",width:`${e}px`,left:r.left+"px",top:r.top+"px"})})(o,r,p,t)}))};var g=Object.freeze({__proto__:null,create:f,element:u});function m(t,e,o,n){if("a"===o&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===o?n:"a"===o?n.call(t):n?n.value:e.get(t)}function w(t,e,o,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,o):i?i.value=o:e.set(t,o),o}const y=t=>t.top,x=t=>t.left+t.width,b=t=>t.top+t.height,O=t=>t.left,v=t=>t.left+t.width/2,$=t=>t.top+t.height/2,E={center:t=>({x:v(t),y:$(t)}),top:t=>({x:v(t),y:y(t)}),right:t=>({x:x(t),y:$(t)}),bottom:t=>({x:v(t),y:b(t)}),left:t=>({x:O(t),y:$(t)})},S=(t,e,o="center",n="center")=>{if(!t||!e)throw"No element given";const{x:i,y:r}=A(t,o),{x:a,y:s}=A(e,n);return{x1:i,y1:r,x2:a,y2:s}},A=(t,e="center")=>{if(!e)throw"No position given";if("string"!=typeof e)throw"The position given is not the required type: pos: "+typeof e;if(!["center","left","right","top","bottom"].includes(e))throw"The position given does not match allowed positions to use! Valid positions are: center, left, right, top or bottom";const o=t.getBoundingClientRect();return E[e](o)},B=({start:t,stop:e})=>{const{x1:o,y1:n,x2:i,y2:r}=S(t,e),a=((t,e,o,n)=>{const i=n-e,r=o-t;let a=Math.atan2(i,r);return a*=180/Math.PI,a})(o,n,i,r);return R(a)},R=t=>t>=22.5&&t<=67.5?"north-west":t>=67.5&&t<=112.5?"north":t>=112.5&&t<=157.5?"north-east":t>=157.5&&t<=202.5?"east":t>=202.5&&t<=247.5?"south-east":t>=247.5&&t<=292.5?"south":t>=292.5&&t<=337.5?"south-west":t>=337.5||t<=22.5&&t>=-22.5?"west":t<=-22.5&&t>=-67.5?"south-west":t<=-67.5&&t>=-112.5?"south":t<=-112.5&&t>=-157.5?"south-east":t<=-157.5&&t>=-202.5?"east":t<=-202.5&&t>=-247.5?"north-east":t<=-247.5&&t>=-292.5?"north":t<=-292.5&&t>=-337.5?"north-west":t<=-337.5?"west":"south";var T,C,L,_,j,z,I;class P{constructor(t,e){T.add(this),C.set(this,void 0),L.set(this,void 0),m(this,T,"m",_).call(this,t,e)}static clearLines(){document.querySelectorAll("path.ph.path:not(.original)").forEach((t=>t.remove()))}connect(){this.draw(m(this,L,"f"))}getPath(t,e){const o=B({stop:e,start:t}),{pos1:n,pos2:i}=m(this,T,"m",j).call(this,o);console.log(o,t,n,e,i);const{x1:r,y1:a,x2:s,y2:p}=S(t,e,n,i);return"M "+r+" "+a+"C "+(r+(s-r)/2)+" "+a+", "+(r+(s-r)/2)+" "+p+", "+s+" "+p}async draw(t){if(!t)throw"No path given to draw!";const e=`ph_draw_path-path-${"_"+Math.random().toString(36).substring(2,11)}`,o=t.cloneNode(!1);if(o.setAttribute("id",e),o.classList.remove("original"),o.classList.add("speccer"),!t.parentNode)throw"No parentNode found for path";this.line=t.parentNode.insertBefore(o,t.nextSibling);const n=this.getPath(this.startElement,this.stopElement);this.line.setAttribute("d",n)}}C=new WeakMap,L=new WeakMap,T=new WeakSet,_=function(t,e){if(!t||!e)throw"Missing inputs startElement and stopElement";if(this.startElement=t,this.stopElement=e,w(this,C,document.getElementById("ph-speccer-svg"),"f"),w(this,L,document.getElementById("ph-speccer-path"),"f"),!m(this,L,"f")||!m(this,C,"f"))throw"Missing required SVG element to draw lines. Please see the documentation";this.connect()},j=function(t){let e,o;switch(t){case"north":e="bottom",o="right";break;case"north-east":case"east":case"south-east":e="left",o="right";break;case"south":e="top",o="right";break;default:e="right",o="left"}return{pos1:e,pos2:o}},window.DrawLine=P,function(t){t.Empty="",t.Left="left",t.Right="right",t.Bottom="bottom",t.Top="top"}(z||(z={})),function(t){t.Outline="outline",t.Enclose="enclose",t.Full="full",t.Left="left",t.Right="right",t.Bottom="bottom",t.Top="top",t.Curve="curve"}(I||(I={}));const q=t=>t.split(" "),k=t=>q(t).includes(I.Full),F=t=>-1===t.indexOf(I.Full)&&-1===t.indexOf(I.Enclose)&&-1!==t.indexOf(I.Curve),M=async(t,e,o,n=!1)=>{const a=r(o),s=i(getComputedStyle(o).getPropertyValue("--ph-speccer-measure-size"))||8;const p=await d(o,e);if(q(t).includes(I.Enclose)){const{left:t,top:e,height:o,width:n}=p.absolute();return{left:`${t}px`,top:`${e}px`,height:`${o}px`,width:`${n}px`}}if((t=>q(t).includes(I.Left))(t)){if(k(t)){const{left:t,top:e,height:o}=p.toLeft({sourceWidth:s});return{left:`${t}px`,top:`${e}px`,height:`${o}px`}}{const{left:t,top:e}=p.toLeft({center:!n,modifier:a});return{left:`${t}px`,top:`${e}px`}}}if((t=>q(t).includes(I.Right))(t)){if(k(t)){const{left:t,top:e,height:o}=p.fromRight({center:!1});return{left:`${t}px`,top:`${e}px`,height:`${o}px`}}{const{left:t,top:e}=p.fromRight({center:!n,modifier:a});return{left:`${t}px`,top:`${e}px`}}}if((t=>q(t).includes(I.Bottom))(t)){if(k(t)){const{left:t,top:e,width:o}=p.fromBottom({center:!1});return{left:`${t}px`,top:`${e}px`,width:`${o}px`}}{const{left:t,top:e}=p.fromBottom({center:!n,modifier:a});return{left:`${n?t+a/2:t}px`,top:`${e}px`}}}if(k(t)){const{left:t,top:e,width:o}=p.toTop({center:!1});return{left:`${t}px`,top:`${e}px`,width:`${o}px`}}{const{left:t,top:e}=p.toTop({center:!n,modifier:a});return{left:`${n?t+a/2:t}px`,top:`${e}px`}}},W=(t="",n,i="span")=>{const r=document.createElement(i),a=document.createTextNode(t),s={};null!==n&&""!==n&&(s[n]=!0),-1===n.indexOf(I.Full)&&-1===n.indexOf(I.Enclose)?r.appendChild(a):-1===n.indexOf(I.Full)&&-1===n.indexOf(I.Enclose)||r.setAttribute("data-dissection-counter",t);const p=o("ph speccer dissection",s);return e(r,p),r},H=t=>{if(!t)return;const e=t.querySelectorAll("[data-anatomy]");e&&e.forEach((async(t,e)=>{if(!t)return Promise.resolve();const o=t.getAttribute("data-anatomy")||"";if(!o||""===o||-1===o.indexOf(I.Outline))return;const i=W(n[e],o);document.body.appendChild(i);const r=await M(o,t,i,F(o));var a;await s(i,r),await(a=500,new Promise((t=>setTimeout(t,a)))),F(o)&&new P(t,i)}))};const N=(t="",o="",n="span")=>{const i=document.createElement(n);return i.setAttribute("title",t+"px"),i.setAttribute("data-measure",parseInt(t+"",10)+"px"),e(i,`ph speccer measure ${o}`),i},V=async t=>{if(!t)return;const e=t.getAttribute("data-speccer-measure");if(""===e||!e)return;const o=await p(t);if("none"===o.display||"0"===o.opacity||"hidden"===o.visibility)return;await a();const n=t.getBoundingClientRect(),i=n.top+window.pageYOffset,r=n.left+window.pageXOffset;if(-1!==e.indexOf("width"))if(-1!==e.indexOf("bottom")){const t=N(n.width,e);document.body.appendChild(t),s(t,{left:r+"px",top:i+n.height+1+"px",width:n.width+"px"})}else{const t=N(n.width,e);document.body.appendChild(t);const o=t.getBoundingClientRect();s(t,{left:r+"px",top:i-o.height+1+"px",width:n.width+"px"})}else if(-1!==e.indexOf("height"))if(-1!==e.indexOf("right")){const t=N(n.height,e);document.body.appendChild(t),s(t,{left:r+n.width+"px",top:i+"px",height:n.height+"px"})}else{const t=N(n.height,e);document.body.appendChild(t);const o=t.getBoundingClientRect();s(t,{left:r-o.width+"px",top:i+"px",height:n.height+"px"})}};const X=(t,e=3)=>parseFloat(t+"").toFixed(e),Y=(t,n)=>{const i=document.createElement("div"),r={};null!==n&&""!==n&&(r[n]=!0);const a=o("ph speccer typography",r);return i.innerHTML=t,e(i,a),i};const D=t=>{const e=()=>function(t,e,o){let n;return function(i,...r){const a=o&&!n;n&&clearTimeout(n),n=setTimeout((function(){n=null,o||t.apply(i,r)}),e),a&&t.apply(i,r)}}((()=>{t()}),300);window.removeEventListener("resize",e),window.addEventListener("resize",e)},G=t=>{"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{t()})):t()},J=()=>{const t=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.intersectionRatio>0&&(u(t.target),e.unobserve(t.target))}))}));document.querySelectorAll("[data-speccer],[data-speccer] *:not(td):not(tr):not(th):not(tfoot):not(thead):not(tbody)").forEach((e=>{t.observe(e)}));const e=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.intersectionRatio>0&&(V(t.target),e.unobserve(t.target))}))}));document.querySelectorAll("[data-speccer-measure]").forEach((t=>{e.observe(t)}));const o=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.intersectionRatio>0&&(H(t.target),e.unobserve(t.target))}))}));document.querySelectorAll("[data-anatomy-section]").forEach((t=>{o.observe(t)}))},K=t=>{window.speccer=t},Q=t=>{const e=document.currentScript;if(e){const o=e.getAttribute("src");!o||-1===o.indexOf("speccer.js")&&-1===o.indexOf("JaXpOK.js")||(e.hasAttribute("data-manual")?K(t):e.hasAttribute("data-instant")?t():e.hasAttribute("data-dom")?G(t):e.hasAttribute("data-lazy")?J():G(t),e.hasAttribute("data-manual")||e.hasAttribute("data-lazy")||D(t))}};const U=g,Z=Object.freeze({__proto__:null,create:W,element:H}),tt=Object.freeze({__proto__:null,element:V}),et=Object.freeze({__proto__:null,create:Y,element:async t=>{if(!t)return;const e=t.getAttribute("data-speccer-typography"),o=await p(t);if("none"===o.display||"0"===o.opacity||"hidden"===o.visibility)return;t.classList.add("is-specced");const n=await(async t=>{const e=(t=>{const{lineHeight:e,letterSpacing:o,fontFamily:n,fontSize:i,fontStyle:r,fontVariationSettings:a,fontWeight:s}=t;return{lineHeight:e,letterSpacing:o,fontFamily:n,fontSize:i,fontStyle:r,fontVariationSettings:a,fontWeight:s}})(await p(t)),o="normal"!==e.lineHeight?parseInt(e.lineHeight,10)/16+"rem":"normal";return`\nfont-styles: {<ul class="speccer-styles">  <li><span class="property">font-family:</span> ${e.fontFamily};</li>  <li><span class="property">font-size:</span> ${e.fontSize} / ${parseInt(e.fontSize,10)/16}rem;</li>  <li><span class="property">font-weight:</span> ${e.fontWeight};</li>  <li><span class="property">font-variation-settings:</span> ${e.fontVariationSettings};</li>  <li><span class="property">line-height:</span> ${e.lineHeight} / ${o};</li>  <li><span class="property">letter-spacing:</span> ${e.letterSpacing};</li>  <li><span class="property">font-style:</span> ${e.fontStyle};</li></ul>}`})(t),i=Y(n,e);document.body.appendChild(i);const a=await(async(t,e,o)=>{const n=e.getBoundingClientRect(),i=r(o),a=o.getBoundingClientRect(),s=await h(e),p=s.left-a.width-i+"px",d=X(l(s.top,a,n))+"px",f=s.left+n.width+i+"px",u=X(l(s.top,a,n))+"px",g=X(c(s.left,a,n))+"px",m=s.top-a.height-i+"px",w=X(c(s.left,a,n))+"px",y=s.top+n.height+i+"px";let x={left:p,top:d};return t&&-1!==t.indexOf(z.Right)?x={left:f,top:u}:t&&-1!==t.indexOf(z.Top)?x={left:g,top:m}:t&&-1!==t.indexOf(z.Bottom)&&(x={left:w,top:y}),x})(e,t,i);s(i,a)}}),ot=Object.freeze({__proto__:null,dom:G,lazy:J,manual:K,activate:Q}),nt=()=>{((t,e=document)=>{[].forEach.call(e.querySelectorAll(t),(function(t){t.remove()}))})(".speccer");const t=document.querySelectorAll("[data-speccer],[data-speccer] *:not(td):not(tr):not(th):not(tfoot):not(thead):not(tbody)"),e=document.querySelectorAll("[data-speccer-measure]"),o=document.querySelectorAll("[data-speccer-typography]"),n=document.querySelectorAll("[data-anatomy-section]");t.forEach(U.element),e.forEach(tt.element),o.forEach(et.element),n.forEach(Z.element)};Q(nt),t.default=nt,t.dissect=Z,t.measure=tt,t.modes=ot,t.spacing=U,t.typography=et,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=speccer.js.map
