!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).speccer={})}(this,(function(t){"use strict";const e=(t,e)=>t.insertAdjacentElement("afterend",e),n=(t,e=document)=>{[].forEach.call(e.querySelectorAll(t),(function(t){t.remove()}))},i=(t,e,n="noop")=>{t&&(!e||e&&0===e.length||e.split(" ").filter((t=>t!==n)).forEach((e=>t.classList.add(e))))},o=t=>parseInt(t,10),p=t=>{const e=parseFloat(t);return e>=0&&e<1||e<=0&&e>-1?0:e},s=(t,e)=>{t&&(!e||e&&0===e.length&&e.constructor===String||e&&0===e.length&&e.constructor===Array||e&&0===Object.keys(e).length&&e.constructor===Object||window.requestAnimationFrame((()=>{"string"==typeof e||Array.isArray(e)?e.forEach((e=>t.style[e.key]=e.value)):Object.keys(e).forEach((n=>t.style[n]=e[n]))})))},a=t=>window.getComputedStyle?getComputedStyle(t,null):t.currentStyle,d=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ"],r=["TR","TH","TD","TBODY","THEAD","TFOOT"],l=(t="",e="span")=>{const n=document.createElement(e),i=document.createTextNode(t);return n.appendChild(i),n.setAttribute("title",t+"px"),n.classList.add("speccer"),n},f=t=>{const n={},d=a(t);if("none"===d.display||"hidden"===d.visibility)return;t.classList.add("speccer-isSpecced");if("static"===a(t.parentElement).position&&(t.parentElement.style.position="relative"),n.style=(t=>{const{marginTop:e,marginBottom:n,marginLeft:i,marginRight:o,paddingTop:p,paddingBottom:s,paddingLeft:a,paddingRight:d}=t;return{marginTop:e,marginBottom:n,marginLeft:i,marginRight:o,paddingTop:p,paddingBottom:s,paddingLeft:a,paddingRight:d}})(d),n.rect=t.getBoundingClientRect(),"0px"!==n.style.marginTop){const a=l(o(n.style.marginTop));i(a,"margin marginTop"),s(a,{height:n.style.marginTop,width:n.rect.width+"px",left:p(n.rect.x-t.parentElement.getBoundingClientRect().x)+"px",top:p(n.rect.y-t.parentElement.getBoundingClientRect().y-parseInt(n.style.marginTop,10))+"px"}),r.indexOf(t.nodeName)>=0?e(t.closest("table"),a):e(t,a)}if("0px"!==n.style.marginRight){const a=l(o(n.style.marginRight));i(a,"margin marginRight"),s(a,{height:n.rect.height+"px",width:n.style.marginRight,left:p(n.rect.x-t.parentElement.getBoundingClientRect().x+parseInt(n.rect.width,10))+"px",top:p(n.rect.y-t.parentElement.getBoundingClientRect().y)+"px"}),r.indexOf(t.nodeName)>=0?e(t.closest("table"),a):e(t,a)}if("0px"!==n.style.marginBottom){const a=l(o(n.style.marginBottom));i(a,"margin marginBottom"),s(a,{height:n.style.marginBottom,width:n.rect.width+"px",left:p(n.rect.x-t.parentElement.getBoundingClientRect().x)+"px",top:p(n.rect.y-t.parentElement.getBoundingClientRect().y+parseInt(n.rect.height,10))+"px"}),r.indexOf(t.nodeName)>=0?e(t.closest("table"),a):e(t,a)}if("0px"!==n.style.marginLeft){const a=l(o(n.style.marginLeft));i(a,"margin marginLeft"),s(a,{height:n.rect.height+"px",width:n.style.marginLeft,left:p(n.rect.x-t.parentElement.getBoundingClientRect().x-parseInt(n.style.marginLeft,10))+"px",top:p(n.rect.y-t.parentElement.getBoundingClientRect().y)+"px"}),r.indexOf(t.nodeName)>=0?e(t.closest("table"),a):e(t,a)}if("0px"!==n.style.paddingTop){const a=l(o(n.style.paddingTop));i(a,"padding paddingTop"),s(a,{height:n.style.paddingTop,width:n.rect.width+"px",left:p(n.rect.x-t.parentElement.getBoundingClientRect().x)+"px",top:p(n.rect.y-t.parentElement.getBoundingClientRect().y)+"px"}),r.indexOf(t.nodeName)>=0?e(t.closest("table"),a):e(t,a)}if("0px"!==n.style.paddingBottom){const a=l(o(n.style.paddingBottom));i(a,"padding paddingBottom"),s(a,{height:n.style.paddingBottom,width:n.rect.width+"px",left:p(n.rect.x-t.parentElement.getBoundingClientRect().x)+"px",top:p(n.rect.y-t.parentElement.getBoundingClientRect().y+(parseInt(n.rect.height,10)-parseInt(n.style.paddingBottom,10)))+"px"}),r.indexOf(t.nodeName)>=0?e(t.closest("table"),a):e(t,a)}if("0px"!==n.style.paddingRight){const a=l(o(n.style.paddingRight));i(a,"padding paddingRight"),s(a,{height:n.rect.height+"px",width:n.style.paddingRight,left:p(n.rect.x-t.parentElement.getBoundingClientRect().x+(parseInt(n.rect.width,10)-parseInt(n.style.paddingRight,10)))+"px",top:p(n.rect.y-t.parentElement.getBoundingClientRect().y)+"px"}),r.indexOf(t.nodeName)>=0?e(t.closest("table"),a):e(t,a)}if("0px"!==n.style.paddingLeft){const a=l(o(n.style.paddingLeft));i(a,"padding paddingLeft"),s(a,{height:n.rect.height+"px",width:n.style.paddingLeft,left:p(n.rect.x-t.parentElement.getBoundingClientRect().x)+"px",top:p(n.rect.y-t.parentElement.getBoundingClientRect().y)+"px"}),r.indexOf(t.nodeName)>=0?e(t.closest("table"),a):e(t,a)}},c=(t,e)=>{const n=t.getBoundingClientRect(),i=t.getAttribute("data-anatomy"),o=((t="",e,n="span")=>{const i=document.createElement(n),o=document.createTextNode(t);return i.classList.add("dissection"),-1===e.indexOf("full")&&-1===e.indexOf("enclose")?i.appendChild(o):-1===e.indexOf("full")&&-1===e.indexOf("enclose")||i.setAttribute("data-dissection-counter",t),e&&(-1!==e.indexOf(" ")?e.split(" ").forEach((t=>{i.classList.add(t)})):i.classList.add(e)),i})(d[e],i),p=r.indexOf(t.nodeName)>=0;let a=0,l=0;if(p){const e=t.closest("table"),n=window.getComputedStyle(e.parentElement);Node.after(e,o),a=e.getBoundingClientRect().top-parseInt(n.getPropertyValue("padding-top"),10),l=e.getBoundingClientRect().left-parseInt(n.getPropertyValue("padding-left"),10)}else Node.after(t,o);const f=o.getBoundingClientRect();let c=(p?n.left-l:t.offsetLeft)-f.width-48+"px",h=(p?n.top-a:t.offsetTop)+n.height/2-f.height/2+"px",g=(p?n.left-l:t.offsetLeft)+n.width+48+"px",x=(p?n.top-a:t.offsetTop)+n.height/2-f.height/2+"px",m=(p?n.left-l:t.offsetLeft)+n.width/2-f.width/2+"px",u=(p?n.top-a:t.offsetTop)-f.height-48+"px",y=(p?n.left-l:t.offsetLeft)+n.width/2-f.width/2+"px",w=(p?n.top-a:t.offsetTop)+n.height+48+"px",O={};O=-1!==i.indexOf("outline")?-1!==i.indexOf("left")?-1!==i.indexOf("full")?{left:t.offsetLeft-8+"px",top:t.offsetTop+-1+"px",height:n.height+"px"}:-1!==i.indexOf("enclose")?{left:t.offsetLeft-1+"px",top:t.offsetTop+-1+"px",height:n.height+"px",width:n.width+"px"}:{left:c,top:h}:-1!==i.indexOf("right")?-1!==i.indexOf("full")?{left:t.offsetLeft+n.width+"px",top:t.offsetTop+-1+"px",height:n.height+"px"}:-1!==i.indexOf("enclose")?{left:t.offsetLeft+-1+"px",top:t.offsetTop+-1+"px",height:n.height+"px",width:n.width+"px"}:{left:g,top:x}:-1!==i.indexOf("top")?-1!==i.indexOf("full")?{bottom:t.offsetTop+n.height+"px",left:t.offsetLeft+-1+"px",width:n.width+"px"}:-1!==i.indexOf("enclose")?{top:t.offsetTop+-1+"px",left:t.offsetLeft+-1+"px",height:n.height+"px",width:n.width+"px"}:{left:m,top:u}:-1!==i.indexOf("bottom")?-1!==i.indexOf("full")?{top:t.offsetTop+n.height+"px",left:t.offsetLeft+-1+"px",width:n.width+"px"}:-1!==i.indexOf("enclose")?{top:t.offsetTop+-1+"px",left:t.offsetLeft+-1+"px",height:n.height+"px",width:n.width+"px"}:{left:y,top:w}:-1!==i.indexOf("full")?{left:t.offsetLeft+n.width+"px",top:t.offsetTop+"px",height:n.height+"px"}:-1!==i.indexOf("enclose")?{left:t.offsetLeft+n.width+"px",top:t.offsetTop+-1+"px",height:n.height+"px",width:n.width+"px"}:{left:c,top:h}:-1!==i.indexOf("full")?{left:t.offsetLeft-8+"px",top:t.offsetTop+-1+"px",height:n.height+"px"}:-1!==i.indexOf("enclose")?{left:t.offsetLeft-1+"px",top:t.offsetTop+-1+"px",height:n.height+"px",width:n.width+"px"}:{left:c,top:h},s(o,O)},h=(t="",e="",n="span")=>{const o=document.createElement(n);return o.setAttribute("title",t+"px"),o.setAttribute("data-measure",parseInt(t,10)+"px"),i(`speccer measure ${e}`),o},g=t=>{if(!t)return;const e=t.getBoundingClientRect(),n=t.getAttribute("data-speccer-measure");if(""!==n)if(-1!==n.indexOf("width"))if(-1!==n.indexOf("bottom")){const n=h(e.width,"width bottom");r.indexOf(t.nodeName)>=0?Node.after(t.closest("table"),n):Node.after(t,n),s(n,{left:t.offsetLeft+"px",top:t.offsetTop+e.height+1+"px",width:e.width+"px"})}else{const n=h(e.width,"width top");r.indexOf(t.nodeName)>=0?Node.after(t.closest("table"),n):Node.after(t,n);const i=n.getBoundingClientRect();s(n,{left:t.offsetLeft+"px",top:t.offsetTop-i.height+1+"px",width:e.width+"px"})}else if(-1!==n.indexOf("height"))if(-1!==n.indexOf("right")){const n=h(e.height,"height right");r.indexOf(t.nodeName)>=0?Node.after(t.closest("table"),n):Node.after(t,n),s(n,{left:t.offsetLeft+e.width+"px",top:t.offsetTop+"px",height:e.height+"px"})}else{const n=h(e.height,"height top");r.indexOf(t.nodeName)>=0?Node.after(t.closest("table"),n):Node.after(t,n);const i=n.getBoundingClientRect();s(n,{left:t.offsetLeft-i.width+"px",top:t.offsetTop+"px",height:e.height+"px"})}},x=t=>parseFloat(t).toFixed(3),m=t=>{const e=t.getAttribute("data-speccer-typography"),n=a(t);if("none"===n.display||"hidden"===n.visibility)return;t.classList.add("speccer-isSpecced");"static"===a(t.parentElement).position&&(t.parentElement.style.position="relative");const o=(t=>{const{lineHeight:e,letterSpacing:n,fontFamily:i,fontSize:o,fontStyle:p,fontVariationSettings:s,fontWeight:a}=t;return{lineHeight:e,letterSpacing:n,fontFamily:i,fontSize:o,fontStyle:p,fontVariationSettings:s,fontWeight:a}})(n),p=t.getBoundingClientRect(),d=((t,e)=>{const n=document.createElement("div");return n.innerHTML=t,i("speccer typography"),""!==e&&(-1!==e.indexOf(" ")?e.split(" ").forEach((t=>{n.classList.add(t)})):n.classList.add(e)),n})(`\n    font-styles: {<ul class="speccer-styles">  <li><span class="property">font-family:</span> ${o.fontFamily};</li>  <li><span class="property">font-size:</span> ${o.fontSize} / ${parseInt(o.fontSize,10)/16}rem;</li>  <li><span class="property">font-weight:</span> ${o.fontWeight};</li>  <li><span class="property">font-variation-settings:</span> ${o.fontVariationSettings};</li>  <li><span class="property">line-height:</span> ${o.lineHeight} / ${parseInt(o.lineHeight,10)/16}rem;</li>  <li><span class="property">letter-spacing:</span> ${o.letterSpacing};</li>  <li><span class="property">font-style:</span> ${o.fontStyle};</li></ul>}`,e);let l=0,f=0;const c=r.indexOf(t.nodeName)>=0;if(c){const e=t.parentElement,n=window.getComputedStyle(e.parentElement);Node.after(e,d),l=e.getBoundingClientRect().top-parseInt(n.getPropertyValue("padding-top"),10),f=e.getBoundingClientRect().left-parseInt(n.getPropertyValue("padding-left"),10)}else Node.after(t,d);const h=d.getBoundingClientRect();let g=(c?h.left-f:t.offsetLeft)-h.width-48+"px",m=x((c?h.top-l:t.offsetTop)-h.height/2+p.height/2)+"px",u=(c?h.left-f:t.offsetLeft)+p.width+48+"px",y=x((c?h.top-l:t.offsetTop)-h.height/2+p.height/2)+"px",w=x((c?h.left-f:t.offsetLeft)-h.width/2+p.width/2)+"px",O=(c?h.top-l:t.offsetTop)-h.height-48+"px",E=x((c?h.left-f:t.offsetLeft)-h.width/2+p.width/2)+"px",L=(c?h.top-l:t.offsetTop)+p.height+48+"px",R={left:g,top:m};-1!==e.indexOf("right")?R={left:u,top:y}:-1!==e.indexOf("top")?R={left:w,top:O}:-1!==e.indexOf("bottom")&&(R={left:E,top:L}),s(d,R)},u=(t,e)=>{((t,e,n)=>{n=n||window;var i=!1,o=function(){i||(i=!0,requestAnimationFrame((function(){n.dispatchEvent(new CustomEvent(e)),i=!1})))};n.removeEventListener(t,o),n.addEventListener(t,o)})("resize","speccer-onResize");const n=()=>{console.info("[@phun-ky/speccer]: Event speccer-onResize triggered"),t(),e()};window.removeEventListener("speccer-onResize",n),window.addEventListener("speccer-onResize",n)},y=(t,e)=>{console.info("[@phun-ky/speccer]: Initialized with: data-dom"),"loading"===document.readyState?(document.addEventListener("DOMContentLoaded",e),document.addEventListener("DOMContentLoaded",t)):(e(),t())},w=()=>{console.info("[@phun-ky/speccer]: Running anatomy()"),n(".dissection"),document.querySelectorAll("[data-anatomy-section]").forEach((t=>{t.querySelectorAll("[data-anatomy]").forEach(c)}))},O=()=>{console.info("[@phun-ky/speccer]: Running speccer()"),n(".speccer");const t=document.querySelectorAll("[data-speccer],[data-speccer] *:not(td)"),e=document.querySelectorAll("[data-speccer-measure]"),i=document.querySelectorAll("[data-speccer-typography]");t.forEach(f),e.forEach(g),i.forEach(m)};((t,e)=>{const n=document.currentScript;if(n){const i=n.getAttribute("src");-1===i.indexOf("speccer.js")&&-1===i.indexOf("JaXpOK.js")||(n.hasAttribute("data-manual")?((t,e)=>{console.info("[@phun-ky/speccer]: Initialized with: data-manual"),window.speccer=t,window.anatomy=e})(t,e):n.hasAttribute("data-instant")?((t,e)=>{e(),t()})(t,e):n.hasAttribute("data-dom")?y(t,e):n.hasAttribute("data-lazy")?(()=>{console.info("[@phun-ky/speccer]: Initialized with: data-lazy");let t=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.intersectionRatio>0&&(f(t.target),e.unobserve(t.target))}))}));document.querySelectorAll("[data-speccer],[data-speccer] *:not(td)").forEach((e=>{t.observe(e)}));let e=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.intersectionRatio>0&&(g(t.target),e.unobserve(t.target))}))}));document.querySelectorAll("[data-speccer-measure]").forEach((t=>{e.observe(t)}));let n=new IntersectionObserver(((t,e)=>{t.forEach((t=>{const n=t.target.querySelectorAll("[data-anatomy]");t.intersectionRatio>0&&(n.forEach(c),e.unobserve(t.target))}))}));document.querySelectorAll("[data-anatomy-section]").forEach((t=>{n.observe(t)}))})():y(t,e),n.hasAttribute("data-manual")||n.hasAttribute("data-lazy")||u())}})(O,w),t.anatomy=w,t.speccer=O,Object.defineProperty(t,"__esModule",{value:!0})}));
