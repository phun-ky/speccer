!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).speccer={})}(this,(function(t){"use strict";const e=(t,e,i="noop")=>{t&&(!e||e&&0===e.length||e.trim().split(" ").filter((t=>t!==i)).forEach((e=>t.classList.add(e))))},i=(t,e)=>t?e||"string"==typeof t?`${t} ${e?Object.keys(e).filter((t=>e[t])).join(" "):""}`.trim():`${Object.keys(t).filter((e=>t[e])).join(" ")}`.trim():"",o=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ"],n=t=>parseInt(t,10),p=t=>n(getComputedStyle(t).getPropertyValue("--ph-speccer-pin-space"))||48,a=()=>new Promise(requestAnimationFrame),l=async(t,e)=>{!t||!e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||Array.isArray(e)&&0===e.length||0===Object.keys(e).length&&e.constructor===Object||(await a(),Array.isArray(e)?e.forEach((e=>t.style[e.key]=e.value)):Object.keys(e).forEach((i=>t.style[i]=e[i])))},r=async t=>(await a(),getComputedStyle(t,null)),c=(t,e,i)=>t-e.width/2+i.width/2,h=(t,e,i)=>t-e.height/2+i.height/2,d=async t=>{await a();const e=t.getBoundingClientRect(),i=e.top+window.pageYOffset,o=e.left+window.pageXOffset;return{height:e.height,width:e.width,top:i,left:o}},s=async(t,e)=>{await a();const i=t.getBoundingClientRect(),o=await d(e),n=await(async(t,e)=>{await a();const i=t.getBoundingClientRect(),o=e.getBoundingClientRect(),n=o.top+window.pageYOffset,p=o.left+window.pageXOffset;return{height:o.height,width:o.width,top:h(n,i,o),left:c(p,i,o)}})(t,e),p=o.height,l=o.width,r=i.height,s=i.width;return{toTop:({center:t=!1,sourceHeight:e=r}={})=>({top:o.top-e,left:t?n.left:o.left,height:p,width:l}),fromTop:({center:t=!1}={})=>({top:o.top,left:t?n.left:o.left,height:p,width:l}),toBottom:({center:t=!1,sourceHeight:e=r,targetHeight:i=p}={})=>({top:o.top+i-e,left:t?n.left:o.left,height:p,width:l}),fromBottom:({center:t=!1,targetHeight:e=p}={})=>({top:o.top+e,left:t?n.left:o.left,height:p,width:l}),toLeft:({center:t=!1,sourceWidth:e=s,modifier:i=0}={})=>({top:t?n.top:o.top,left:o.left-e-i,height:p,width:l}),fromLeft:({center:t=!1}={})=>({top:t?n.top:o.top,left:o.left,height:p,width:l}),toRight:({center:t=!1,sourceWidth:e=s,targetWidth:i=l,modifier:a=0}={})=>({top:t?n.top:o.top,left:o.left+i-e+a,height:p,width:l}),fromRight:({center:t=!1,targetWidth:e=l}={})=>({top:t?n.top:o.top,left:o.left+e,height:p,width:l})}},f=(t="",i="span")=>{const o=document.createElement(i),n=document.createTextNode(t+"");return o.appendChild(n),o.setAttribute("title",t+"px"),e(o,"ph speccer spacing"),o},g=async t=>{if(!t)return;const i=await r(t);if("none"===i.display||"0"===i.opacity||"hidden"===i.visibility)return;const o=(t=>{const{marginTop:e,marginBottom:i,marginLeft:o,marginRight:n,paddingTop:p,paddingBottom:a,paddingLeft:l,paddingRight:r}=t;return{marginTop:e,marginBottom:i,marginLeft:o,marginRight:n,paddingTop:p,paddingBottom:a,paddingLeft:l,paddingRight:r}})(i),p=Object.keys(o).filter((t=>"0px"!==o[t]));0!==p.length&&p.forEach((async i=>{const p=n(o[i]),r=f(p),c=(t=>-1!==t.indexOf("Top")?t.replace("Top"," top"):-1!==t.indexOf("Right")?t.replace("Right"," right"):-1!==t.indexOf("Bottom")?t.replace("Bottom"," bottom"):-1!==t.indexOf("Left")?t.replace("Left"," left"):"")(i);e(r,c),document.body.appendChild(r),t.classList.add("is-specced"),await(async(t,e,i,o)=>{await a();const n=o.getBoundingClientRect(),p=await d(o);"marginTop"===t&&l(i,{height:`${e}px`,width:n.width+"px",left:p.left+"px",top:p.top-e+"px"}),"marginRight"===t&&l(i,{height:n.height+"px",width:`${e}px`,left:p.left+parseInt(n.width+"",10)+"px",top:p.top+"px"}),"marginBottom"===t&&l(i,{height:`${e}px`,width:n.width+"px",left:p.left+"px",top:p.top+parseInt(n.height+"",10)+"px"}),"marginLeft"===t&&l(i,{height:n.height+"px",width:`${e}px`,left:p.left-e+"px",top:p.top+"px"}),"paddingTop"===t&&l(i,{height:`${e}px`,width:n.width+"px",left:p.left+"px",top:p.top+"px"}),"paddingBottom"===t&&l(i,{height:`${e}px`,width:n.width+"px",left:p.left+"px",top:p.top+(parseInt(n.height+"",10)-e)+"px"}),"paddingRight"===t&&l(i,{height:n.height+"px",width:`${e}px`,left:p.left+(parseInt(n.width+"",10)-e)+"px",top:p.top+"px"}),"paddingLeft"===t&&l(i,{height:n.height+"px",width:`${e}px`,left:p.left+"px",top:p.top+"px"})})(i,p,r,t)}))};var u,x,m=Object.freeze({__proto__:null,create:f,element:g});!function(t){t.Empty="",t.Left="left",t.Right="right",t.Bottom="bottom",t.Top="top"}(u||(u={})),function(t){t.Outline="outline",t.Enclose="enclose",t.Full="full",t.Left="left",t.Right="right",t.Bottom="bottom",t.Top="top"}(x||(x={}));const w=(t,e=3)=>parseFloat(t+"").toFixed(e),y=async(t,e,i)=>{const o=p(i),a=n(getComputedStyle(i).getPropertyValue("--ph-speccer-measure-size"))||8;const l=-1*a,r=e.getBoundingClientRect(),f=i.getBoundingClientRect(),g=await d(e),u=g.left-f.width-o+"px",m=w(h(g.top,f,r))+"px";g.left,r.width,w(h(g.top,f,r));const y=w(c(g.left,f,r))+"px",O=g.top-f.height-o+"px",b=w(c(g.left,f,r))+"px",E=g.top+r.height+o+"px",$=await s(i,e);let R={};if(-1!==t.indexOf(x.Left))if(-1!==t.indexOf(x.Full)){const{left:t,top:e,height:i}=$.toLeft({sourceWidth:a});R={left:`${t}px`,top:`${e}px`,height:`${i}px`}}else if(-1!==t.indexOf(x.Enclose)){const{left:t,top:e,height:i,width:o}=$.fromTop();R={left:`${t}px`,top:`${e}px`,height:`${i}px`,width:`${o}px`}}else{const{left:t,top:e}=$.toLeft({center:!0,modifier:o});R={left:`${t}px`,top:`${e}px`}}else if(-1!==t.indexOf(x.Right))if(-1!==t.indexOf(x.Full))R={left:g.left+r.width+"px",top:g.top+"px",height:r.height+"px"};else if(-1!==t.indexOf(x.Enclose))R={left:g.left+"px",top:g.top+"px",height:r.height+"px",width:r.width+"px"};else{const{left:t,top:e}=$.fromRight({center:!0,modifier:o});R={left:`${t}px`,top:`${e}px`}}else R=-1!==t.indexOf(x.Top)?-1!==t.indexOf(x.Full)?{top:g.top+l+"px",left:g.left+"px",width:r.width+"px"}:-1!==t.indexOf(x.Enclose)?{top:g.top+"px",left:g.left+"px",height:r.height+"px",width:r.width+"px"}:{left:y,top:O}:-1!==t.indexOf(x.Bottom)?-1!==t.indexOf(x.Full)?{top:g.top+r.height+"px",left:g.left+"px",width:r.width+"px"}:-1!==t.indexOf(x.Enclose)?{top:g.top+"px",left:g.left+"px",height:r.height+"px",width:r.width+"px"}:{left:b,top:E}:-1!==t.indexOf(x.Full)?{left:g.left+r.width+"px",top:g.top+"px",height:r.height+"px"}:-1!==t.indexOf(x.Enclose)?{left:g.left+r.width+"px",top:g.top+"px",height:r.height+"px",width:r.width+"px"}:{left:u,top:m};return R},O=(t="",o,n="span")=>{const p=document.createElement(n),a=document.createTextNode(t),l={};null!==o&&""!==o&&(l[o]=!0),-1===o.indexOf(x.Full)&&-1===o.indexOf(x.Enclose)?p.appendChild(a):-1===o.indexOf(x.Full)&&-1===o.indexOf(x.Enclose)||p.setAttribute("data-dissection-counter",t);const r=i("ph speccer dissection",l);return e(p,r),p},b=t=>{if(!t)return;const e=t.querySelectorAll("[data-anatomy]");e&&e.forEach((async(t,e)=>{if(!t)return;const i=t.getAttribute("data-anatomy")||"";if(!i||""===i||-1===i.indexOf(x.Outline))return;const n=O(o[e],i);document.body.appendChild(n);const p=await y(i,t,n);l(n,p)}))};const E=(t="",i="",o="span")=>{const n=document.createElement(o);return n.setAttribute("title",t+"px"),n.setAttribute("data-measure",parseInt(t+"",10)+"px"),e(n,`ph speccer measure ${i}`),n},$=async t=>{if(!t)return;const e=t.getAttribute("data-speccer-measure");if(""===e||!e)return;const i=await r(t);if("none"===i.display||"0"===i.opacity||"hidden"===i.visibility)return;await a();const o=t.getBoundingClientRect(),n=o.top+window.pageYOffset,p=o.left+window.pageXOffset;if(-1!==e.indexOf("width"))if(-1!==e.indexOf("bottom")){const t=E(o.width,e);document.body.appendChild(t),l(t,{left:p+"px",top:n+o.height+1+"px",width:o.width+"px"})}else{const t=E(o.width,e);document.body.appendChild(t);const i=t.getBoundingClientRect();l(t,{left:p+"px",top:n-i.height+1+"px",width:o.width+"px"})}else if(-1!==e.indexOf("height"))if(-1!==e.indexOf("right")){const t=E(o.height,e);document.body.appendChild(t),l(t,{left:p+o.width+"px",top:n+"px",height:o.height+"px"})}else{const t=E(o.height,e);document.body.appendChild(t);const i=t.getBoundingClientRect();l(t,{left:p-i.width+"px",top:n+"px",height:o.height+"px"})}};const R=(t,o)=>{const n=document.createElement("div"),p={};null!==o&&""!==o&&(p[o]=!0);const a=i("ph speccer typography",p);return n.innerHTML=t,e(n,a),n};const A=t=>{const e=()=>function(t,e,i){let o;return function(n,...p){const a=i&&!o;o&&clearTimeout(o),o=setTimeout((function(){o=null,i||t.apply(n,p)}),e),a&&t.apply(n,p)}}((()=>{t()}),300);window.removeEventListener("resize",e),window.addEventListener("resize",e)},S=t=>{"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{t()})):t()},B=()=>{const t=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.intersectionRatio>0&&(g(t.target),e.unobserve(t.target))}))}));document.querySelectorAll("[data-speccer],[data-speccer] *:not(td):not(tr):not(th):not(tfoot):not(thead):not(tbody)").forEach((e=>{t.observe(e)}));const e=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.intersectionRatio>0&&($(t.target),e.unobserve(t.target))}))}));document.querySelectorAll("[data-speccer-measure]").forEach((t=>{e.observe(t)}));const i=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.intersectionRatio>0&&(b(t.target),e.unobserve(t.target))}))}));document.querySelectorAll("[data-anatomy-section]").forEach((t=>{i.observe(t)}))},C=t=>{window.speccer=t},L=t=>{const e=document.currentScript;if(e){const i=e.getAttribute("src");!i||-1===i.indexOf("speccer.js")&&-1===i.indexOf("JaXpOK.js")||(e.hasAttribute("data-manual")?C(t):e.hasAttribute("data-instant")?t():e.hasAttribute("data-dom")?S(t):e.hasAttribute("data-lazy")?B():S(t),e.hasAttribute("data-manual")||e.hasAttribute("data-lazy")||A(t))}};const v=m,T=Object.freeze({__proto__:null,create:O,element:b}),_=Object.freeze({__proto__:null,element:$}),j=Object.freeze({__proto__:null,create:R,element:async t=>{if(!t)return;const e=t.getAttribute("data-speccer-typography"),i=await r(t);if("none"===i.display||"0"===i.opacity||"hidden"===i.visibility)return;t.classList.add("is-specced");const o=await(async t=>{const e=(t=>{const{lineHeight:e,letterSpacing:i,fontFamily:o,fontSize:n,fontStyle:p,fontVariationSettings:a,fontWeight:l}=t;return{lineHeight:e,letterSpacing:i,fontFamily:o,fontSize:n,fontStyle:p,fontVariationSettings:a,fontWeight:l}})(await r(t)),i="normal"!==e.lineHeight?parseInt(e.lineHeight,10)/16+"rem":"normal";return`\nfont-styles: {<ul class="speccer-styles">  <li><span class="property">font-family:</span> ${e.fontFamily};</li>  <li><span class="property">font-size:</span> ${e.fontSize} / ${parseInt(e.fontSize,10)/16}rem;</li>  <li><span class="property">font-weight:</span> ${e.fontWeight};</li>  <li><span class="property">font-variation-settings:</span> ${e.fontVariationSettings};</li>  <li><span class="property">line-height:</span> ${e.lineHeight} / ${i};</li>  <li><span class="property">letter-spacing:</span> ${e.letterSpacing};</li>  <li><span class="property">font-style:</span> ${e.fontStyle};</li></ul>}`})(t),n=R(o,e);document.body.appendChild(n);const a=await(async(t,e,i)=>{const o=e.getBoundingClientRect(),n=p(i),a=i.getBoundingClientRect(),l=await d(e),r=l.left-a.width-n+"px",s=w(h(l.top,a,o))+"px",f=l.left+o.width+n+"px",g=w(h(l.top,a,o))+"px",x=w(c(l.left,a,o))+"px",m=l.top-a.height-n+"px",y=w(c(l.left,a,o))+"px",O=l.top+o.height+n+"px";let b={left:r,top:s};return t&&-1!==t.indexOf(u.Right)?b={left:f,top:g}:t&&-1!==t.indexOf(u.Top)?b={left:x,top:m}:t&&-1!==t.indexOf(u.Bottom)&&(b={left:y,top:O}),b})(e,t,n);l(n,a)}}),z=Object.freeze({__proto__:null,dom:S,lazy:B,manual:C,activate:L}),F=()=>{((t,e=document)=>{[].forEach.call(e.querySelectorAll(t),(function(t){t.remove()}))})(".speccer");const t=document.querySelectorAll("[data-speccer],[data-speccer] *:not(td):not(tr):not(th):not(tfoot):not(thead):not(tbody)"),e=document.querySelectorAll("[data-speccer-measure]"),i=document.querySelectorAll("[data-speccer-typography]"),o=document.querySelectorAll("[data-anatomy-section]");t.forEach(v.element),e.forEach(_.element),i.forEach(j.element),o.forEach(T.element)};L(F),t.default=F,t.dissect=T,t.measure=_,t.modes=z,t.spacing=v,t.typography=j,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=speccer.js.map
