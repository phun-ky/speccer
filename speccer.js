!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).speccer={})}(this,(function(t){"use strict";const e=(t,e,o="noop")=>{t&&(!e||e&&0===e.length||e.trim().split(" ").filter((t=>t!==o)).forEach((e=>t.classList.add(e))))},o=(t,e)=>t?e||"string"==typeof t?`${t} ${e?Object.keys(e).filter((t=>e[t])).join(" "):""}`.trim():`${Object.keys(t).filter((e=>t[e])).join(" ")}`.trim():"",i=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ"],n=t=>parseInt(t,10),p=t=>n(getComputedStyle(t).getPropertyValue("--ph-speccer-pin-space"))||48,r=()=>new Promise(requestAnimationFrame),a=async(t,e)=>{!t||!e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||Array.isArray(e)&&0===e.length||0===Object.keys(e).length&&e.constructor===Object||(await r(),Array.isArray(e)?e.forEach((e=>t.style[e.key]=e.value)):Object.keys(e).forEach((o=>t.style[o]=e[o])))},s=async t=>(await r(),getComputedStyle(t,null)),l=(t,e,o)=>t-e.width/2+o.width/2,h=(t,e,o)=>t-e.height/2+o.height/2,c=async t=>{await r();const e=t.getBoundingClientRect(),o=e.top+window.pageYOffset,i=e.left+window.pageXOffset;return{height:e.height,width:e.width,top:o,left:i}},d=async(t,e)=>{await r();const o=t.getBoundingClientRect(),i=await c(e),n=await(async(t,e)=>{await r();const o=t.getBoundingClientRect(),i=e.getBoundingClientRect(),n=i.top+window.pageYOffset,p=i.left+window.pageXOffset;return{height:i.height,width:i.width,top:h(n,o,i),left:l(p,o,i)}})(t,e),p=i.height,a=i.width,s=o.height,d=o.width;return{toTop:({center:t=!1,sourceHeight:e=s}={})=>({top:i.top-e,left:t?n.left:i.left,height:p,width:a}),fromTop:({center:t=!1}={})=>({top:i.top,left:t?n.left:i.left,height:p,width:a}),toBottom:({center:t=!1,sourceHeight:e=s,targetHeight:o=p}={})=>({top:i.top+o-e,left:t?n.left:i.left,height:p,width:a}),fromBottom:({center:t=!1,targetHeight:e=p}={})=>({top:i.top+e,left:t?n.left:i.left,height:p,width:a}),toLeft:({center:t=!1,sourceWidth:e=d,modifier:o=0}={})=>({top:t?n.top:i.top,left:i.left-e-o,height:p,width:a}),fromLeft:({center:t=!1}={})=>({top:t?n.top:i.top,left:i.left,height:p,width:a}),toRight:({center:t=!1,sourceWidth:e=d,targetWidth:o=a,modifier:r=0}={})=>({top:t?n.top:i.top,left:i.left+o-e+r,height:p,width:a}),fromRight:({center:t=!1,targetWidth:e=a}={})=>({top:t?n.top:i.top,left:i.left+e,height:p,width:a})}},f=(t="",o="span")=>{const i=document.createElement(o),n=document.createTextNode(t+"");return i.appendChild(n),i.setAttribute("title",t+"px"),e(i,"ph speccer spacing"),i},g=async t=>{if(!t)return;const o=await s(t);if("none"===o.display||"0"===o.opacity||"hidden"===o.visibility)return;const i=(t=>{const{marginTop:e,marginBottom:o,marginLeft:i,marginRight:n,paddingTop:p,paddingBottom:r,paddingLeft:a,paddingRight:s}=t;return{marginTop:e,marginBottom:o,marginLeft:i,marginRight:n,paddingTop:p,paddingBottom:r,paddingLeft:a,paddingRight:s}})(o),p=Object.keys(i).filter((t=>"0px"!==i[t]));0!==p.length&&p.forEach((async o=>{const p=n(i[o]),s=f(p),l=(t=>-1!==t.indexOf("Top")?t.replace("Top"," top"):-1!==t.indexOf("Right")?t.replace("Right"," right"):-1!==t.indexOf("Bottom")?t.replace("Bottom"," bottom"):-1!==t.indexOf("Left")?t.replace("Left"," left"):"")(o);e(s,l),document.body.appendChild(s),t.classList.add("is-specced"),await(async(t,e,o,i)=>{await r();const n=i.getBoundingClientRect(),p=await c(i);"marginTop"===t&&a(o,{height:`${e}px`,width:n.width+"px",left:p.left+"px",top:p.top-e+"px"}),"marginRight"===t&&a(o,{height:n.height+"px",width:`${e}px`,left:p.left+parseInt(n.width+"",10)+"px",top:p.top+"px"}),"marginBottom"===t&&a(o,{height:`${e}px`,width:n.width+"px",left:p.left+"px",top:p.top+parseInt(n.height+"",10)+"px"}),"marginLeft"===t&&a(o,{height:n.height+"px",width:`${e}px`,left:p.left-e+"px",top:p.top+"px"}),"paddingTop"===t&&a(o,{height:`${e}px`,width:n.width+"px",left:p.left+"px",top:p.top+"px"}),"paddingBottom"===t&&a(o,{height:`${e}px`,width:n.width+"px",left:p.left+"px",top:p.top+(parseInt(n.height+"",10)-e)+"px"}),"paddingRight"===t&&a(o,{height:n.height+"px",width:`${e}px`,left:p.left+(parseInt(n.width+"",10)-e)+"px",top:p.top+"px"}),"paddingLeft"===t&&a(o,{height:n.height+"px",width:`${e}px`,left:p.left+"px",top:p.top+"px"})})(o,p,s,t)}))};var u=Object.freeze({__proto__:null,create:f,element:g});const x=t=>t.top,m=t=>t.left+t.width,y=t=>t.top+t.height,w=t=>t.left,b=t=>t.left+t.width/2,O=t=>t.top+t.height/2,_={center:t=>({x:b(t),y:O(t)}),top:t=>({x:b(t),y:x(t)}),right:t=>({x:m(t),y:O(t)}),bottom:t=>({x:b(t),y:y(t)}),left:t=>({x:w(t),y:O(t)})},E=(t,e,o="center",i="center")=>{if(!t||!e)throw"No element given";const{x:n,y:p}=A(t,o),{x:r,y:a}=A(e,i);return{x1:n,y1:p,x2:r,y2:a}},A=(t,e="center")=>{if(!e)throw"No position given";if("string"!=typeof e)throw"The position given is not the required type: pos: "+typeof e;if(!["center","left","right","top","bottom"].includes(e))throw"The position given does not match allowed positions to use! Valid positions are: center, left, right, top or bottom";const o=t.getBoundingClientRect();return _[e](o)},$=({start:t,stop:e})=>{const{x1:o,y1:i,x2:n,y2:p}=E(t,e),r=((t,e,o,i)=>{const n=i-e,p=o-t;let r=Math.atan2(n,p);return r*=180/Math.PI,r})(o,i,n,p);return R(r)},R=t=>t>=22.5&&t<=67.5?"north-west":t>=67.5&&t<=112.5?"north":t>=112.5&&t<=157.5?"north-east":t>=157.5&&t<=202.5?"east":t>=202.5&&t<=247.5?"south-east":t>=247.5&&t<=292.5?"south":t>=292.5&&t<=337.5?"south-west":t>=337.5||t<=22.5&&t>=-22.5?"west":t<=-22.5&&t>=-67.5?"south-west":t<=-67.5&&t>=-112.5?"south":t<=-112.5&&t>=-157.5?"south-east":t<=-157.5&&t>=-202.5?"east":t<=-202.5&&t>=-247.5?"north-east":t<=-247.5&&t>=-292.5?"north":t<=-292.5&&t>=-337.5?"north-west":t<=-337.5?"west":"south",S=function(){this._init()};var v,B;S.prototype._clear_lines=function(){document.querySelectorAll("path.ph.path:not(.original)").forEach((t=>t.remove()))},S.prototype._init=function(){if(this._original_path_el=document.getElementById("ph-speccer-path"),!this._original_path_el)throw"Missing target SVG. Are you sure you have added it in the DOM?"},S.prototype.connect=function(t,e){this._line(this._original_path_el,t,e)},S.prototype._get_positions_for_path=function(t){let e,o;switch(t){case"north":e="bottom",o="top";break;case"north-east":case"east":case"south-east":e="left",o="right";break;case"south":e="top",o="bottom";break;default:e="right",o="left"}return{pos1:e,pos2:o}},S.prototype._get_path=function(t,e){const o=$({stop:e,start:t});console.log(o);const{pos1:i,pos2:n}=this._get_positions_for_path(o),{x1:p,y1:r,x2:a,y2:s}=E(t,e,i,n);return"M "+p+" "+r+"C "+(p+(a-p)/2)+" "+r+", "+(p+(a-p)/2)+" "+s+", "+a+" "+s},S.prototype._line=function(t,e,o){if(!e||!o)return;const i=`ph_draw_path-path-${"_"+Math.random().toString(36).substring(2,11)}`,n=t.cloneNode(!1);n.setAttribute("id",i),n.classList.remove("original"),t.parentNode&&t.parentNode.insertBefore(n,t.nextSibling);const p=this._get_path(e,o);n.setAttribute("d",p)},function(t){t.Empty="",t.Left="left",t.Right="right",t.Bottom="bottom",t.Top="top"}(v||(v={})),function(t){t.Outline="outline",t.Enclose="enclose",t.Full="full",t.Left="left",t.Right="right",t.Bottom="bottom",t.Top="top"}(B||(B={}));const C=(t,e=3)=>parseFloat(t+"").toFixed(e),T=async(t,e,o)=>{const i=p(o),r=n(getComputedStyle(o).getPropertyValue("--ph-speccer-measure-size"))||8;const a=-1*r,s=e.getBoundingClientRect(),f=o.getBoundingClientRect(),g=await c(e),u=g.left-f.width-i+"px",x=C(h(g.top,f,s))+"px";g.left,s.width,C(h(g.top,f,s));const m=C(l(g.left,f,s))+"px",y=g.top-f.height-i+"px",w=C(l(g.left,f,s))+"px",b=g.top+s.height+i+"px",O=await d(o,e);let _={};if(-1!==t.indexOf(B.Left))if(-1!==t.indexOf(B.Full)){const{left:t,top:e,height:o}=O.toLeft({sourceWidth:r});_={left:`${t}px`,top:`${e}px`,height:`${o}px`}}else if(-1!==t.indexOf(B.Enclose)){const{left:t,top:e,height:o,width:i}=O.fromTop();_={left:`${t}px`,top:`${e}px`,height:`${o}px`,width:`${i}px`}}else{const{left:t,top:e}=O.toLeft({center:!0,modifier:i});_={left:`${t}px`,top:`${e}px`}}else if(-1!==t.indexOf(B.Right))if(-1!==t.indexOf(B.Full))_={left:g.left+s.width+"px",top:g.top+"px",height:s.height+"px"};else if(-1!==t.indexOf(B.Enclose))_={left:g.left+"px",top:g.top+"px",height:s.height+"px",width:s.width+"px"};else{const{left:t,top:e}=O.fromRight({center:!0,modifier:i});_={left:`${t}px`,top:`${e}px`}}else _=-1!==t.indexOf(B.Top)?-1!==t.indexOf(B.Full)?{top:g.top+a+"px",left:g.left+"px",width:s.width+"px"}:-1!==t.indexOf(B.Enclose)?{top:g.top+"px",left:g.left+"px",height:s.height+"px",width:s.width+"px"}:{left:m,top:y}:-1!==t.indexOf(B.Bottom)?-1!==t.indexOf(B.Full)?{top:g.top+s.height+"px",left:g.left+"px",width:s.width+"px"}:-1!==t.indexOf(B.Enclose)?{top:g.top+"px",left:g.left+"px",height:s.height+"px",width:s.width+"px"}:{left:w,top:b}:-1!==t.indexOf(B.Full)?{left:g.left+s.width+"px",top:g.top+"px",height:s.height+"px"}:-1!==t.indexOf(B.Enclose)?{left:g.left+s.width+"px",top:g.top+"px",height:s.height+"px",width:s.width+"px"}:{left:u,top:x};return _},L=(t="",i,n="span")=>{const p=document.createElement(n),r=document.createTextNode(t),a={};null!==i&&""!==i&&(a[i]=!0),-1===i.indexOf(B.Full)&&-1===i.indexOf(B.Enclose)?p.appendChild(r):-1===i.indexOf(B.Full)&&-1===i.indexOf(B.Enclose)||p.setAttribute("data-dissection-counter",t);const s=o("ph speccer dissection",a);return e(p,s),p},j=t=>{if(!t)return;const e=t.querySelectorAll("[data-anatomy]");e&&e.forEach((async(t,e)=>{if(!t)return;const o=t.getAttribute("data-anatomy")||"";if(!o||""===o||-1===o.indexOf(B.Outline))return;const n=L(i[e],o);document.body.appendChild(n);const p=await T(o,t,n);a(n,p),-1===o.indexOf("full")&&-1===o.indexOf("enclose")&&setTimeout((()=>{(new S).connect(t,n)}),1e3)}))};const z=(t="",o="",i="span")=>{const n=document.createElement(i);return n.setAttribute("title",t+"px"),n.setAttribute("data-measure",parseInt(t+"",10)+"px"),e(n,`ph speccer measure ${o}`),n},F=async t=>{if(!t)return;const e=t.getAttribute("data-speccer-measure");if(""===e||!e)return;const o=await s(t);if("none"===o.display||"0"===o.opacity||"hidden"===o.visibility)return;await r();const i=t.getBoundingClientRect(),n=i.top+window.pageYOffset,p=i.left+window.pageXOffset;if(-1!==e.indexOf("width"))if(-1!==e.indexOf("bottom")){const t=z(i.width,e);document.body.appendChild(t),a(t,{left:p+"px",top:n+i.height+1+"px",width:i.width+"px"})}else{const t=z(i.width,e);document.body.appendChild(t);const o=t.getBoundingClientRect();a(t,{left:p+"px",top:n-o.height+1+"px",width:i.width+"px"})}else if(-1!==e.indexOf("height"))if(-1!==e.indexOf("right")){const t=z(i.height,e);document.body.appendChild(t),a(t,{left:p+i.width+"px",top:n+"px",height:i.height+"px"})}else{const t=z(i.height,e);document.body.appendChild(t);const o=t.getBoundingClientRect();a(t,{left:p-o.width+"px",top:n+"px",height:i.height+"px"})}};const I=(t,i)=>{const n=document.createElement("div"),p={};null!==i&&""!==i&&(p[i]=!0);const r=o("ph speccer typography",p);return n.innerHTML=t,e(n,r),n};const q=t=>{const e=()=>function(t,e,o){let i;return function(n,...p){const r=o&&!i;i&&clearTimeout(i),i=setTimeout((function(){i=null,o||t.apply(n,p)}),e),r&&t.apply(n,p)}}((()=>{t()}),300);window.removeEventListener("resize",e),window.addEventListener("resize",e)},H=t=>{"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{t()})):t()},M=()=>{const t=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.intersectionRatio>0&&(g(t.target),e.unobserve(t.target))}))}));document.querySelectorAll("[data-speccer],[data-speccer] *:not(td):not(tr):not(th):not(tfoot):not(thead):not(tbody)").forEach((e=>{t.observe(e)}));const e=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.intersectionRatio>0&&(F(t.target),e.unobserve(t.target))}))}));document.querySelectorAll("[data-speccer-measure]").forEach((t=>{e.observe(t)}));const o=new IntersectionObserver(((t,e)=>{t.forEach((t=>{t.intersectionRatio>0&&(j(t.target),e.unobserve(t.target))}))}));document.querySelectorAll("[data-anatomy-section]").forEach((t=>{o.observe(t)}))},k=t=>{window.speccer=t},W=t=>{const e=document.currentScript;if(e){const o=e.getAttribute("src");!o||-1===o.indexOf("speccer.js")&&-1===o.indexOf("JaXpOK.js")||(e.hasAttribute("data-manual")?k(t):e.hasAttribute("data-instant")?t():e.hasAttribute("data-dom")?H(t):e.hasAttribute("data-lazy")?M():H(t),e.hasAttribute("data-manual")||e.hasAttribute("data-lazy")||q(t))}};const N=u,V=Object.freeze({__proto__:null,create:L,element:j}),P=Object.freeze({__proto__:null,element:F}),X=Object.freeze({__proto__:null,create:I,element:async t=>{if(!t)return;const e=t.getAttribute("data-speccer-typography"),o=await s(t);if("none"===o.display||"0"===o.opacity||"hidden"===o.visibility)return;t.classList.add("is-specced");const i=await(async t=>{const e=(t=>{const{lineHeight:e,letterSpacing:o,fontFamily:i,fontSize:n,fontStyle:p,fontVariationSettings:r,fontWeight:a}=t;return{lineHeight:e,letterSpacing:o,fontFamily:i,fontSize:n,fontStyle:p,fontVariationSettings:r,fontWeight:a}})(await s(t)),o="normal"!==e.lineHeight?parseInt(e.lineHeight,10)/16+"rem":"normal";return`\nfont-styles: {<ul class="speccer-styles">  <li><span class="property">font-family:</span> ${e.fontFamily};</li>  <li><span class="property">font-size:</span> ${e.fontSize} / ${parseInt(e.fontSize,10)/16}rem;</li>  <li><span class="property">font-weight:</span> ${e.fontWeight};</li>  <li><span class="property">font-variation-settings:</span> ${e.fontVariationSettings};</li>  <li><span class="property">line-height:</span> ${e.lineHeight} / ${o};</li>  <li><span class="property">letter-spacing:</span> ${e.letterSpacing};</li>  <li><span class="property">font-style:</span> ${e.fontStyle};</li></ul>}`})(t),n=I(i,e);document.body.appendChild(n);const r=await(async(t,e,o)=>{const i=e.getBoundingClientRect(),n=p(o),r=o.getBoundingClientRect(),a=await c(e),s=a.left-r.width-n+"px",d=C(h(a.top,r,i))+"px",f=a.left+i.width+n+"px",g=C(h(a.top,r,i))+"px",u=C(l(a.left,r,i))+"px",x=a.top-r.height-n+"px",m=C(l(a.left,r,i))+"px",y=a.top+i.height+n+"px";let w={left:s,top:d};return t&&-1!==t.indexOf(v.Right)?w={left:f,top:g}:t&&-1!==t.indexOf(v.Top)?w={left:u,top:x}:t&&-1!==t.indexOf(v.Bottom)&&(w={left:m,top:y}),w})(e,t,n);a(n,r)}}),Y=Object.freeze({__proto__:null,dom:H,lazy:M,manual:k,activate:W}),D=()=>{((t,e=document)=>{[].forEach.call(e.querySelectorAll(t),(function(t){t.remove()}))})(".speccer");const t=document.querySelectorAll("[data-speccer],[data-speccer] *:not(td):not(tr):not(th):not(tfoot):not(thead):not(tbody)"),e=document.querySelectorAll("[data-speccer-measure]"),o=document.querySelectorAll("[data-speccer-typography]"),i=document.querySelectorAll("[data-anatomy-section]");t.forEach(N.element),e.forEach(P.element),o.forEach(X.element),i.forEach(V.element)};W(D),t.default=D,t.dissect=V,t.measure=P,t.modes=Y,t.spacing=N,t.typography=X,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=speccer.js.map
